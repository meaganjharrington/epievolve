inits = list(beta = 0.30, I0 = 10),
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
View(out)
summary(out$Rt_series)
plot(out$Rt_series)
View(out)
devtools::load_all()
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
View(out)
plot(out$St_series)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
head(out$Rt_series)
out$diagnostics$acceptance_proxy
plot(out$St_series)
plot(out$Rt_series)
head(df)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(17, 35)
inits = list(beta = 0.30, I0 = 10),
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35)
inits = list(beta = 0.30, I0 = 10),
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
library(EpiEstim)
res_parametric_si <- estimate_R(df,
method="parametric_si",
config = make_config(list(
mean_si = 2.6,
std_si = 1.5))
)
View(df)
df$I <- df$cases
res_parametric_si <- estimate_R(df,
method="parametric_si",
config = make_config(list(
mean_si = 2.6,
std_si = 1.5))
)
plot(res_parametric_si, legend = FALSE)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e6,
gamma = 1/6,
beta_breaks = c(1,17, 35),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
plot(out$Rt_series)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
plot(out$Rt_series)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 2000,
gamma = 1/6,
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
plot(out$Rt_series)
library(EpiEstim)
res_parametric_si <- estimate_R(df,
method="parametric_si",
config = make_config(list(
mean_si = 2.6,
std_si = 1.5))
)
df$I <- df$cases
res_parametric_si <- estimate_R(df,
method="parametric_si",
config = make_config(list(
mean_si = 2.6,
std_si = 1.5))
)
plot(res_parametric_si, legend = FALSE)
View(inc)
View(inc)
View(out)
load_all()
load_all()
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(17, 35)
inits = list(beta = 0.30, I0 = 10),
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
plot(out$Rt_series)
plot(out$Rt_series, out$Rt_lower, out$Rt_upper)
rt_df <- data.frame(
time = out$Rt_series$time,
Rt_median = out$Rt_series$Rt_median,
Rt_lower  = out$Rt_lower,
Rt_upper  = out$Rt_upper
)
library(ggplot2)
ggplot(rt_df, aes(x = time)) +
geom_ribbon(
aes(ymin = Rt_lower, ymax = Rt_upper),
fill = "steelblue",
alpha = 0.25
) +
geom_line(
aes(y = Rt_median),
color = "steelblue4",
linewidth = 1
) +
geom_hline(yintercept = 1, linetype = "dashed", colour = "grey40") +
labs(
x = "Time",
y = expression(R[t]),
title = expression("Estimated " * R[t] * " with 95% credible interval")
) +
theme_minimal(base_size = 13)
library(ggplot2)
ggplot(rt_df, aes(x = time)) +
geom_ribbon(
aes(ymin = Rt_lower, ymax = Rt_upper),
fill = "steelblue",
alpha = 0.25
) +
geom_line(
aes(y = Rt_median),
color = "steelblue4",
linewidth = 1
) +
geom_hline(yintercept = 1, linetype = "dashed", colour = "grey40") +
labs(
x = "Time",
y = expression(R[t]),
title = expression("Estimated " * R[t] * " with 95% credible interval")
) +
theme_minimal(base_size = 13)
View(out)
View(rt_df)
library(ggplot2)
ggplot(rt_df, aes(x = time)) +
geom_ribbon(
aes(ymin = Rt_lower.Rt_lower, ymax = Rt_upper.Rt_upper),
fill = "steelblue",
alpha = 0.25
) +
geom_line(
aes(y = Rt_median),
color = "steelblue4",
linewidth = 1
) +
geom_hline(yintercept = 1, linetype = "dashed", colour = "grey40") +
labs(
x = "Time",
y = expression(R[t]),
title = expression("Estimated " * R[t] * " with 95% credible interval")
) +
theme_minimal(base_size = 13)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
View(out)
out$diagnostics
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
View(out)
View(out)
devtools::load_all()
df <- read.csv("tests/testthat/incidence.csv", stringsAsFactors = FALSE)
names(df) <- tolower(names(df))
df$time  <- as.integer(df$time)
df$cases <- as.integer(df$cases)
stopifnot(all(diff(df$time) == 1L))
out <- final_estimate_Rt_step(
incidence = df,
N = 1e4,
gamma = 1/6,
beta_breaks = c(1, 40, 55),
inits = list(beta = 0.30, I0 = 10),
priors = list(mean_beta = log(0.30), sd_beta = 0.5,
rw_sd_beta = 0.2, mean_I0 = log(10), sd_I0 = 0.6),
mcmc  = list(n_steps = 6000, burnin = 0.5, seed = 42, n_rt_draws = 300)
)
View(out)
View(out)
library(EpiEstim)
df$I <- df$cases
res_parametric_si <- estimate_R(df$I,
method="parametric_si",
config = make_config(list(
mean_si = 2.6,
std_si = 1.5))
)
res_parametric_si
plot(res_parametric_si, legend = FALSE)
View(out)
View(out)
plot(out$Rt_series)
